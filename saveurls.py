#!/bin/python3 

import os
import time

domain = input("Enter domain or subdomain name: ")
with open(f"{domain}", 'r') as subdomains:
	domain = subdomains.read()
	domain = domain.split('\n')
	if "" in domain:
		domain.remove("")

files = os.system('ls > list.txt')
with open("list.txt", 'r') as f:
	file = f.read()
	file = file.split('\n')
	if "" in file:
		file.remove("")

new_domains = []

#check if file exists
for m in domain:
	new_list_item = m + ".txt"
	#check line count
	if new_list_item in file:
		with open(f"{new_list_item}", 'r') as item:
			item = item.read()
			item = item.split('\n')
			if "" in item:
				item.remove("")
		line_count = len(item)
		if line_count > 0:
			pass
		else:
			print(f"{new_list_item} has nothing, appending to new list")
			filename = new_list_item.split('.txt')
			new_domains.append(filename[0])
			rm = os.system(f'rm {new_list_item}')
	elif new_list_item not in file:
		print(f"{new_list_item} Appending to new list")
		filename = new_list_item.split('.txt')
		new_domains.append(filename[0])

rm = os.system('rm list.txt')


count = len(new_domains)
if count > 0:
	for l in new_domains:
		print("Working on", l)
		domain = l
		urls = os.system(f'waybackurls {domain} > {domain}.txt')
		with open(f"{domain}.txt", 'r') as f:
			file = f.read()
			url_list = file.split('\n')

		if "" in url_list:
			url_list.remove("")

		k = 0
		for i in url_list:
			k = k + 1

		if k > 0:
			pass
		else:
			print("Nothing in the file")
			remove = os.system(f'rm {domain}.txt')
else:
	print("Nothing to work on")
